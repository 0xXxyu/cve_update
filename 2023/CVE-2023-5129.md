### [CVE-2023-5129](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-5129)
![](https://img.shields.io/static/v1?label=Product&message=libwebp&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=0.5.0%3C%201.3.2%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-20%20Improper%20Input%20Validation&color=brighgreen)

### Description

With a specially crafted WebP lossless file, libwebp may write data out of bounds to the heap.The ReadHuffmanCodes() function allocates the HuffmanCode buffer with a size that comes from an array of precomputed sizes: kTableSize. The color_cache_bits value defines which size to use.The kTableSize array only takes into account sizes for 8-bit first-level table lookups but not second-level table lookups. libwebp allows codes that are up to 15-bit (MAX_ALLOWED_CODE_LENGTH). When BuildHuffmanTable() attempts to fill the second-level tables it may write data out-of-bounds. The OOB write to the undersized array happens in ReplicateValue.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/kherrick/hacker-news

