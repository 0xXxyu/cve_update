### [CVE-2016-5399](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5399)
![](https://img.shields.io/static/v1?label=Product&message=Red%20Hat%20Enterprise%20Linux%207&color=blue)
![](https://img.shields.io/static/v1?label=Product&message=Red%20Hat%20Software%20Collections%20for%20Red%20Hat%20Enterprise%20Linux%206&color=blue)
![](https://img.shields.io/static/v1?label=Product&message=Red%20Hat%20Software%20Collections%20for%20Red%20Hat%20Enterprise%20Linux%206.7%20EUS&color=blue)
![](https://img.shields.io/static/v1?label=Product&message=Red%20Hat%20Software%20Collections%20for%20Red%20Hat%20Enterprise%20Linux%207&color=blue)
![](https://img.shields.io/static/v1?label=Product&message=Red%20Hat%20Software%20Collections%20for%20Red%20Hat%20Enterprise%20Linux%207.2%20EUS&color=blue)
![](https://img.shields.io/static/v1?label=Product&message=Red%20Hat%20Software%20Collections%20for%20Red%20Hat%20Enterprise%20Linux%207.3%20EUS&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=!%200%3A2.3-1.el6%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Version&message=!%200%3A2.3-1.el7%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Version&message=!%200%3A5.4.16-42.el7%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=Detection%20of%20Error%20Condition%20Without%20Action&color=brighgreen)

### Description

A flaw was found in the way certain error conditions were handled by bzread() function in PHP. An attacker could use this flaw to upload a specially crafted bz2 archive which, when parsed via the vulnerable function, could cause the application to crash or execute arbitrary code with the permissions of the user running the PHP application.

### POC

#### Reference
- http://packetstormsecurity.com/files/137998/PHP-7.0.8-5.6.23-5.5.37-bzread-OOB-Write.html
- http://seclists.org/fulldisclosure/2016/Jul/72
- http://www.openwall.com/lists/oss-security/2016/07/21/1
- https://www.exploit-db.com/exploits/40155/

#### Github
- https://github.com/syadg123/pigat
- https://github.com/teamssix/pigat

